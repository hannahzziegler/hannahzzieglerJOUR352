---
title: "352_data_analysis"
output: html_document
date: '2022-05-03'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}

library(tidycensus)
library(tidyverse)
library(janitor)
library(dplyr)

author_title_book_bans <- read_csv("author_title_bans.csv")

state_district_book_bans <- read_csv("state_district_bans.csv")

top_10_state_bans <- state_district_book_bans %>%
  group_by(State) %>%
  summarise(count = n()) %>%
  arrange(desc(count)) %>%
  head(10)

write_csv(top_10_state_bans, "top_10_state_bans.csv")

states_for_map <- state_district_book_bans %>%
  group_by(State) %>%
  summarise(count = n()) %>%
  arrange(desc(count))

write_csv(states_for_map, "states_for_map.csv")

district_bans <- state_district_book_bans %>%
  group_by(District, State) %>%
  summarise(count = n()) %>%
  arrange(desc(count))

top_banned_books <- author_title_book_bans %>%
  group_by(Title) %>%
  summarise(count = n()) %>%
  arrange(desc(count))

write_csv(top_banned_books, "top_banned_books.csv")

state_district_book_bans %>%
  summarise(
    total_bans = n())

top_10_state_bans %>%
  mutate(percent_total_bans = (count/1586)*100)

```

